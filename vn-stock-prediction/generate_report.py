# -*- coding: utf-8 -*-
"""Untitled2.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/15YEBuUwPqF8Tz_rrS34iAll1kgJy4Ttr
"""

import pandas as pd

def format_table_markdown(df, title):
    header = "| M√£_M√¥_H√¨nh | " + " | ".join(df.columns) + " |\n"
    separator = "|" + "|".join(["---"] * (len(df.columns) + 1)) + "|\n"
    rows = "\n".join(
        f"| {idx} | " + " | ".join(f"{v:.4f}" if isinstance(v, float) else str(v) for v in row)
        for idx, row in df.iterrows()
    )
    return f"### {title}\n\n" + header + separator + rows + "\n"

if __name__ == "__main__":
    path = "vn-stock-prediction/reports/model_summary.csv"
    report_path = "vn-stock-prediction/report.md"

    df = pd.read_csv(path, index_col=0)
    df = df.sort_values("MAPE")

    top_models = df.head(10)
    markdown_table = format_table_markdown(top_models, "üìä Top 10 m√¥ h√¨nh c√≥ MAPE th·∫•p nh·∫•t")

    intro = "# üìà B√°o C√°o T·ªïng H·ª£p D·ª± ƒêo√°n Gi√° C·ªï Phi·∫øu\n\n"
    intro += "B√°o c√°o n√†y ƒë∆∞·ª£c sinh t·ª± ƒë·ªông t·ª´ k·∫øt qu·∫£ hu·∫•n luy·ªán nhi·ªÅu m√¥ h√¨nh Machine Learning v√† Deep Learning.\n\n"
    intro += "## 1. K·∫øt qu·∫£ m√¥ h√¨nh t·ªët nh·∫•t:\n\n"

    with open(report_path, "w", encoding="utf-8") as f:
        f.write(intro + markdown_table)

    print(f"‚úÖ ƒê√£ t·∫°o b√°o c√°o Markdown t·∫°i: {report_path}")
